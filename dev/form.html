<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <title>&lt;mb-form-string&gt; Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <script type="module" src="../build/mb-form-string.js"></script>
    <script type="module" src="../build/mb-form-textarea.js"></script>
    <script type="module" src="../build/mb-form-integer.js"></script>
    <script type="module" src="../build/mb-form-range.js"></script>
    <script type="module" src="../build/mb-form-number.js"></script>
    <script type="module" src="../build/mb-form-date.js"></script>
    <script type="module" src="../build/mb-form-time.js"></script>
    <script type="module" src="../build/mb-form-datetime.js"></script>
    <script type="module" src="../build/mb-form-boolean.js"></script>
    <script type="module" src="../build/mb-form-enum.js"></script>
    <script type="module" src="../build/mb-form-nstate.js"></script>
    <script type="module" src="../build/mb-form-object.js"></script>
    <script type="module" src="../build/mb-form-array.js"></script>
    <script type="module" src="../build/mb-form.js"></script>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-sm-8">
                <mb-form style="width: 100%;" id="form"></mb-form>
            </div>
            <div class="col-sm-4">
                <div id="log"></div>
            </div>
        </div>
    </div>
</body>
<script>
    const schema = {
        "definitions": {
            "adresse": {
                "type": "object",
                "title" : "adresse",
                "properties": {
                    "type": { "type": "string", "enum": ["domicile", "travail", "vacances", "facturation", "autre"] },
                    "numero": { "type": "integer" },
                    "rep": { "type": "string", title: "répétition", "enum": ['', 'bis', 'ter', 'quater', "quinquies", "sexies", "septies", "octies", "nonies", "decies"] },
                    "voie": { "type": "string" },
                    "complement": { "type": "string" },
                    "commune": { "type": "string" },
                    "codepost": { "type": "string", pattern: '[0-9]{5}' },
                },
                "required": ["numero", "voie", "codepost", "commune"]
            },
            "fuzzy": {
                "type": "boolean",
                "oneOf": [
                    { "const": true, "title": "oui" },
                    { "const": false, "title": "non" },
                    { "const": null, "title": "inconnu" },
                ]
            }
        },
        "type": "object",
        "title": "Compte rendu",
        "properties": {
            "notmandatory": { "type": "string", "title": "any string", },
            "verylong": { "type": "string", "title": "very long", "maxLength": 500 },
            "string": {
                "type": "string",
                "title": "input string",
                "minLength": 5,
                "maxLength": 10,
                "pattern": "^[a-zA-Z ]*$"
            },
            "password": { "type": "string", "format": "password", "title": "password string", },
            "color": { "type": "string", "format": "color", "title": "color", "default": "#FF0000", },
            "email": { "type": "string", "format": "email", "title": "email string", },
            "url": { "type": "string", "format": "uri", "title": "url string", },
            "boolean": { "type": "boolean", "title": "input boolean", },
            "integer": {
                "type": "integer",
                "title": "input integer",
                "minimum": -100,
                "maximum": 100,
                "maximumExclusive": true
            },
            "range": {
                "type": "integer",
                "title": "input range",
                "minimum": 1,
                "maximum": 5,
            },
            "number": {
                "type": "number",
                "title": "input number",
                "minimum": 0.5,
                "maximum": 3.5,
                "maximumExclusive": true
            },
            "date": { "type": "string", "format": "date", "title": "input date", },
            "time": { "type": "string", "format": "time", "title": "input time", },
            "datetime": { "type": "string", "format": "date-time", "title": "input datetime", },
            "fuzzy": { "$ref": "#/definitions/fuzzy" },
            "enum": { "type": "string", "title": "input enum", "enum": ["a", "b", "c", "d", "e"] },
            "enum2": {
                "type": "integer",
                "title": "input enum 2",
                "oneOf": [
                    { "const": 1, "title": "Priorité Haute" },
                    { "const": 2, "title": "Priorité Moyenne" },
                    { "const": 3, "title": "Priorité Basse" },
                    { "const": 4, "title": "Priorité nulle" },
                ]
            },
            "arrayint": {
                "type": "array",
                "title": "array of integers",
                "items": { "type": "integer", "default": 5, "minimum": 0 },
                "minItems": 3,
                "maxItems": 5
            },
            "arrayadr": {
                "type": "array",
                "title": "array of adresse",
                "items": { "$ref": "#/definitions/adresse" },
                "minItems": 1,
                "maxItems": 3
            },
            "maison": { "$ref": "#/definitions/adresse" },
            "error": { "type": "zztype", "title": "input error", }
        },
        required: ["string",
            "password",
            "integer",
            "number",
            "time",
            "datetime",
            "enum",
            "enum2",
            "adresse",
            "error"
        ]
    }

    const data = {
        "notmandatory": 'a string',
        "string": 'a',
        "boolean": true,
        "password": 'dontsayit',
        "color": "#0000FF",
        "integer": 5,
        "range": 1,
        "number": 2.71828,
        "date": new Date(),
        "time": '13:15',
        "datetime": new Date(),
        "enum": "b",
        "enum2": null,
        "arrayint": [10, 20, 30],
        "arrayadr": [
            { numero: 12, voie: "rue chapon", commune: "Paris", codepost: "75003" }
        ],
        "maison": { type: "travail", numero: 10, voie: "rue Amiral Mouchez", commune: "Paris", codepost: "75014" },
        "error": 12
    }
    window.addEventListener('load', () => {
        const field = document.getElementById('form')
        field.schema = schema
        field.data = data
        const log = document.getElementById('log')
        setInterval(() => {
            log.innerHTML = `<pre>${JSON.stringify(data, undefined, 4).replace(/\n/g, '<br>')}</pre>`
        }, 500)
    })
</script>

</html>